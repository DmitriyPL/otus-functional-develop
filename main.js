!function(){"use strict";var e={562:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Cell=void 0,t.Cell=class{constructor(e){this.nextType="",this.x=0,this.y=0,this.type=e}setType(e){this.type=e}setNextType(e){this.nextType=e}setX(e){this.x=e}setY(e){this.y=e}getX(){return this.x}getY(){return this.y}getType(){return this.type}getNextType(){return this.nextType}}},92:function(e,t,s){Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0;const i=s(562);t.Field=class{constructor(e,t,s,i){this.state=[],this.drawingCells=new Set,this.analyzedCells=new Set,this.aliveCells=0,this.stateChanged=!1,this.canvasX=0,this.canvasY=0,this.canvas=e,this.fieldSizeX=t,this.fieldSizeY=s,this.cellSize=i,this.ctx=this.canvas.getContext("2d")}defaultSetup(){this.drawingCells.clear(),this.analyzedCells.clear(),this.aliveCells=0,this.stateChanged=!1}initFieldState(){for(let e=0;e<this.fieldSizeY;++e){const t=[];for(let s=0;s<this.fieldSizeX;++s){const l=new i.Cell("dead");l.setX(s),l.setY(e),t.push(l)}this.state.push(t)}}setFieldSize(e,t,s){this.fieldSizeX=e,this.fieldSizeY=t,this.cellSize=s}setupCanvas(){this.canvas.width=this.fieldSizeX*this.cellSize,this.canvas.height=this.fieldSizeY*this.cellSize}setCurrentType(){this.analyzedCells.forEach((e=>{const t=e.getType(),s=e.getNextType();s!==t&&""!==s?e.setType(s):this.drawingCells.delete(e)}))}setNextType(){this.stateChanged=!1,this.analyzedCells.forEach((e=>{const t=this.getNeighboursCoords(e.getX(),e.getY()),s=this.getAliveNeighbours(t);"dead"===e.getType()&&3===s?(e.setNextType("alive"),this.aliveCells+=1,this.stateChanged=!0,this.addCellForDrawing(e)):"alive"===e.getType()&&(s<2||s>3)&&(e.setNextType("dead"),this.aliveCells-=1,this.stateChanged=!0,this.addCellForDrawing(e))}))}getAliveCells(){return this.aliveCells}getStateChanged(){return this.stateChanged}getNeighboursCoords(e,t){return[[e-1,t-1],[e-1,t],[e-1,t+1],[e,t-1],[e,t+1],[e+1,t-1],[e+1,t],[e+1,t+1]]}getAliveNeighbours(e){let t=0;for(const s of e){const e=s[0],i=s[1];"alive"===this.getCellType(e,i)&&(t+=1)}return t}getCellType(e,t){if(e<0||e>this.fieldSizeX-1||t<0||t>this.fieldSizeY-1)return"dead";const s=this.state[t][e];return void 0===s?"dead":s.getType()}delCells(){this.state.length=0}clearCellTypes(){this.state.forEach((e=>{e.forEach((e=>{e.setType("dead"),e.setNextType("")}))}))}addCell(e,t,s){this.state[t][e]=s}addCellForDrawing(e){this.drawingCells.add(e),this.getNeighboursCoords(e.getX(),e.getY()).forEach((e=>{const t=e[0],s=e[1];if(t>=0&&t<=this.fieldSizeX-1&&s>=0&&s<=this.fieldSizeY-1){const e=this.state[s][t];this.analyzedCells.add(e)}})),this.analyzedCells.add(e)}draw(){const e=this.cellSize;this.drawingCells.forEach((t=>{const s=t.getX()*e,i=t.getY()*e;"dead"===t.getType()?(this.ctx.clearRect(s,i,e,e),this.ctx.strokeRect(s,i,e,e)):"dead"===t.getNextType()?(this.ctx.fillStyle="blue",this.ctx.fillRect(s,i,e,e)):(this.ctx.fillStyle="black",this.ctx.fillRect(s,i,e,e))}))}drawEmptyField(){const e=this.cellSize;for(let t=0;t<this.fieldSizeY;++t)for(let s=0;s<this.fieldSizeX;++s)this.ctx.clearRect(s*e,t*e,e,e),this.ctx.strokeRect(s*e,t*e,e,e)}}}},t={};function s(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}!function(){const e=s(92);function t(e,t){localStorage.setItem("stopGame","false");const s=setInterval((()=>{e.setNextType(),e.draw(),e.setCurrentType(),!1!==e.getStateChanged()&&"true"!==localStorage.getItem("stopGame")||clearInterval(s)}),t);return localStorage.setItem("refreshId",String(s)),s}function i(){const e=document.getElementById("gameSpeed");return Number(e.value)}function l(){const e=document.getElementById("sizeX"),t=document.getElementById("sizeY"),s=document.getElementById("cellSize");return{fieldSizeX:Number(e.value),fieldSizeY:Number(t.value),cellSize:Number(s.value)}}function a(e){this.canvasX=this.canvas.offsetLeft+this.canvas.clientLeft,this.canvasY=this.canvas.offsetTop+this.canvas.clientTop;const t=e.pageX-this.canvasX,s=e.pageY-this.canvasY,i=Math.trunc(t/this.cellSize),l=Math.trunc(s/this.cellSize),a=this.state[l][i];"dead"===a.getType()?(a.setType("alive"),this.aliveCells+=1):(a.setType("dead"),this.aliveCells-=1),this.addCellForDrawing(a),this.draw()}function n(t){const{fieldSizeX:s,fieldSizeY:i,cellSize:n}=l(),d=new e.Field(t,s,i,n);return d.initFieldState(),d.setupCanvas(),t.addEventListener("click",a.bind(d)),d}!function(){localStorage.setItem("stopGame","false");const e=n(document.getElementById("game-field"));e.drawEmptyField(),document.getElementById("set-field-size").addEventListener("click",(function(t){t.preventDefault(),function(e){const{fieldSizeX:t,fieldSizeY:s,cellSize:i}=l();e.delCells(),e.defaultSetup(),e.setFieldSize(t,s,i),e.initFieldState(),e.setupCanvas(),e.drawEmptyField()}(e)})),document.getElementById("do-step").addEventListener("click",(function(){e.setNextType(),e.draw(),e.setCurrentType()})),document.getElementById("clear-field").addEventListener("click",(function(){e.defaultSetup(),e.clearCellTypes(),e.drawEmptyField()})),document.getElementById("start-game").addEventListener("click",(function(s){s.preventDefault();const l=i();t(e,l)})),document.getElementById("stop-game").addEventListener("click",(function(e){e.preventDefault(),localStorage.setItem("stopGame","true")})),document.getElementById("set-game-speed").addEventListener("click",(function(s){s.preventDefault(),localStorage.setItem("stopGame","true");const l=Number(localStorage.getItem("refreshId"));clearInterval(l);const a=i();t(e,a)}))}()}()}();